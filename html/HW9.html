
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ECES 512 HW 9</title><meta name="generator" content="MATLAB 9.2"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-03-11"><meta name="DC.source" content="HW9.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>ECES 512 HW 9</h1><!--introduction--><p>Bhautik Amin</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Instructor Problem 1</a></li></ul></div><h2 id="1">Instructor Problem 1</h2><p>Given the system:</p><pre class="codeinput">A = diag([-1 -2, -100, -200])
B = [1;1;1;1]
C = [1 1 0.5 0.5]
D = 0
</pre><pre class="codeoutput">
A =

    -1     0     0     0
     0    -2     0     0
     0     0  -100     0
     0     0     0  -200


B =

     1
     1
     1
     1


C =

    1.0000    1.0000    0.5000    0.5000


D =

     0

</pre><p>Find the balanced realization and compare the transfer functions to original and balanced realization</p><pre class="codeinput">sys_org = ss(A,B,C,D);
</pre><p>Original System Transfer Function</p><pre class="codeinput">sys_tf_org = zpk(sys_org)
</pre><pre class="codeoutput">
sys_tf_org =
 
  3 (s+173) (s+77.51) (s+1.499)
  -----------------------------
   (s+200) (s+100) (s+2) (s+1)
 
Continuous-time zero/pole/gain model.

</pre><p>Balanced Realization Transfer Function (balread() returns: [Realization, Hankel Singular Values )</p><pre class="codeinput">[sys_bal, G] = balreal(sys_tf_org);

tf_bal = zpk(sys_bal)
</pre><pre class="codeoutput">
tf_bal =
 
  3 (s+1.499) (s+77.51) (s+173)
  -----------------------------
   (s+200) (s+100) (s+2) (s+1)
 
Continuous-time zero/pole/gain model.

</pre><p>Find a reduced order system by eliminating the two states from the balanced realization that have the lowest Hankel singular values</p><pre class="codeinput">G'
</pre><pre class="codeoutput">
ans =

    0.7312    0.0192    0.0033    0.0001

</pre><p>We can see that the last two states have the lowest singular values</p><pre class="codeinput">sys_reduced = modred(sys_bal, 3:4,<span class="string">'Truncate'</span>)
sys_tf_red = zpk(sys_reduced)
</pre><pre class="codeoutput">
sys_reduced =
 
  A = 
            x1       x2
   x1   -1.351  -0.6811
   x2  -0.6811   -3.438
 
  B = 
            u1
   x1   -1.406
   x2  -0.3636
 
  C = 
            x1       x2
   y1   -1.406  -0.3636
 
  D = 
       u1
   y1   0
 
Continuous-time state-space model.


sys_tf_red =
 
   2.1078 (s+2.977)
  ------------------
  (s+1.148) (s+3.64)
 
Continuous-time zero/pole/gain model.

</pre><p>Compare the results by looking at the bode plots of each</p><pre class="codeinput">figure(1)
bodeplot(sys_tf_org, sys_tf_red, <span class="string">'r--'</span>)
</pre><img vspace="5" hspace="5" src="HW9_01.png" style="width:560px;height:420px;" alt=""> <p>Where in the dotted red line represents the reduced order system and the blue represents the original system. We can see that the reduced order system's phase plot is has a noticiable difference than the original system.</p><p>From the bode plot, we can see that the</p><p>Compare the step response of the original and reduced order system. Look at the final value and also the initial rise time (blow up graphs and see this around the initial and terminal values)</p><pre class="codeinput">figure(2)
step(sys_tf_org)
title(<span class="string">'Original System Step Response'</span>)
figure(3)
step(sys_tf_red)
title(<span class="string">'Reduced Order System Step Response'</span>)
figure(4)
step(sys_tf_org)
hold <span class="string">on</span>;
step(sys_tf_red)
title(<span class="string">'Original and Reduced Step Response'</span>)
</pre><img vspace="5" hspace="5" src="HW9_02.png" style="width:560px;height:420px;" alt=""> <img vspace="5" hspace="5" src="HW9_03.png" style="width:560px;height:420px;" alt=""> <img vspace="5" hspace="5" src="HW9_04.png" style="width:560px;height:420px;" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2017a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% ECES 512 HW 9
% Bhautik Amin

%% Instructor Problem 1
% Given the system:
A = diag([-1 -2, -100, -200])
B = [1;1;1;1]
C = [1 1 0.5 0.5]
D = 0
%%
% Find the balanced realization and compare the transfer functions to
% original and balanced realization

sys_org = ss(A,B,C,D);
%%
% Original System Transfer Function
sys_tf_org = zpk(sys_org)

%%
% Balanced Realization Transfer Function (balread() returns: [Realization, Hankel Singular
% Values )
[sys_bal, G] = balreal(sys_tf_org);

tf_bal = zpk(sys_bal)


%%
% Find a reduced order system by eliminating the two states from the
% balanced realization that have the lowest Hankel singular values

G'
%%
% We can see that the last two states have the lowest singular values

sys_reduced = modred(sys_bal, 3:4,'Truncate')
sys_tf_red = zpk(sys_reduced)

%%
% Compare the results by looking at the bode plots of each
figure(1)
bodeplot(sys_tf_org, sys_tf_red, 'rREPLACE_WITH_DASH_DASH')

%%
% Where in the dotted red line represents the reduced order system and the
% blue represents the original system. We can see that the reduced order
% system's phase plot is has a noticiable difference than the original
% system. 

%%
% From the bode plot, we can see that the 

%%
% Compare the step response of the original and reduced order system. Look
% at the final value and also the initial rise time (blow up graphs and see
% this around the initial and terminal values)
figure(2)
step(sys_tf_org)
title('Original System Step Response')
figure(3)
step(sys_tf_red)
title('Reduced Order System Step Response')
figure(4)
step(sys_tf_org)
hold on;
step(sys_tf_red)
title('Original and Reduced Step Response')













##### SOURCE END #####
--></body></html>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>extra_credit</title><meta name="generator" content="MATLAB 9.3"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-12-03"><meta name="DC.source" content="extra_credit.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">CASE I</a></li><li><a href="#2">Part 1</a></li><li><a href="#3">Part 2</a></li><li><a href="#4">Part 3a</a></li><li><a href="#5">Part 3b</a></li><li><a href="#6">Part 3c</a></li><li><a href="#7">Part 3d</a></li><li><a href="#8">Part 4a</a></li><li><a href="#9">Part 4b</a></li><li><a href="#10">Case II</a></li><li><a href="#11">Part 1</a></li><li><a href="#12">Part 2</a></li><li><a href="#13">Part 3a</a></li><li><a href="#14">Part 3b</a></li><li><a href="#15">Part 3c</a></li><li><a href="#16">Part 4a</a></li><li><a href="#17">Part 4b</a></li></ul></div><h2 id="1">CASE I</h2><pre class="codeinput">close <span class="string">all</span>
<span class="comment">%setting initial condition</span>
A = [-5.0];
B = [2.0];
C = [1.0];
D = [0];
t = 0.1;
IC = 1;
U = 0;
sys = ss(A,B,C,D);
[Yc, Tc] = initial(sys, IC, 0:t:2);

<span class="comment">% State Discretition</span>
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
yd = [];
yd(1) = 1;
Td = [];
Td(1) = 0;
<span class="comment">% Exact Discrete</span>
<span class="keyword">for</span> i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; <span class="comment">% save corresponding discrete time integer index</span>
<span class="keyword">end</span>
</pre><h2 id="2">Part 1</h2><pre class="codeinput">fprintf(<span class="string">"After discretization Ad = expm(-5*t) Bd = ((-2/5)*expm(-5*t)) + (2/5)"</span>)
fprintf(<span class="string">"State Equation: X[k+1] = Ad*X[k] + Bd*U[k]"</span>)
fprintf(<span class="string">"Y[k] = X[k]"</span>)
</pre><pre class="codeoutput">After discretization Ad = expm(-5*t) Bd = ((-2/5)*expm(-5*t)) + (2/5)State Equation: X[k+1] = Ad*X[k] + Bd*U[k]Y[k] = X[k]</pre><h2 id="3">Part 2</h2><pre class="codeinput">figure
hold <span class="string">on</span>
initial(sys, IC, 0:0.1:2)

yd = [];
yd(1) = 1;
Td = [];
Td(1) = 0;
<span class="comment">% Exact Discrete</span>
t = 0.1;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
<span class="keyword">for</span> i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; <span class="comment">% save corresponding discrete time integer index</span>
<span class="keyword">end</span>
ed = stem(Td*t,yd, <span class="string">'*'</span>, <span class="string">'DisplayName'</span>, <span class="string">'Exact Discrete'</span>);
ed.Color = <span class="string">'red'</span>;
t = 0.3;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
<span class="keyword">for</span> i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; <span class="comment">% save corresponding discrete time integer index</span>
<span class="keyword">end</span>
ed = stem(Td*t,yd, <span class="string">'*'</span>, <span class="string">'DisplayName'</span>, <span class="string">'Exact Discrete'</span>);
ed.Color = <span class="string">'green'</span>;
t = 0.5;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
<span class="keyword">for</span> i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; <span class="comment">% save corresponding discrete time integer index</span>
<span class="keyword">end</span>
ed = stem(Td*t,yd, <span class="string">'*'</span>, <span class="string">'DisplayName'</span>, <span class="string">'Exact Discrete'</span>);
ed.Color = <span class="string">'blue'</span>;
legend(<span class="string">'CT'</span>,<span class="string">'DT  T=0.1'</span>,  <span class="string">'DT  T=0.3'</span>, <span class="string">'DT  T=0.5'</span>)

hold <span class="string">off</span>
fprintf(<span class="string">"\nThe continous time signal is stable because as t approaches infinity, the amplitude approaches 0"</span>)
fprintf(<span class="string">"\nThe discrete time signal is stabel for any time T &gt; 0 can be seen from the graph as well for T = 0.1, 0.3, 0.5, the amplitude also approaches 0"</span>)
</pre><pre class="codeoutput">
The continous time signal is stable because as t approaches infinity, the amplitude approaches 0
The discrete time signal is stabel for any time T &gt; 0 can be seen from the graph as well for T = 0.1, 0.3, 0.5, the amplitude also approaches 0</pre><img vspace="5" hspace="5" src="extra_credit_01.png" alt=""> <h2 id="4">Part 3a</h2><pre class="codeinput">figure
fprintf(<span class="string">"\nClose form continuous signal is x(t) = e^(A*t) * x(0) \n y(t) = x(t)"</span>)
I = imread(<span class="string">'d.jpg'</span>);
imshow(I)
</pre><pre class="codeoutput">
Close form continuous signal is x(t) = e^(A*t) * x(0) 
 y(t) = x(t)Warning: Image is too big to fit on screen; displaying at 33% 
</pre><img vspace="5" hspace="5" src="extra_credit_02.png" alt=""> <h2 id="5">Part 3b</h2><pre class="codeinput">figure
hold <span class="string">on</span>
initial(sys, IC, 0:t:2)
ed = stem(Td*t,yd, <span class="string">'*'</span>, <span class="string">'DisplayName'</span>, <span class="string">'Exact Discrete'</span>);
ed.Color = <span class="string">'red'</span>;
legend(<span class="string">'CT'</span>,<span class="string">'DT  T=0.1'</span>)
</pre><img vspace="5" hspace="5" src="extra_credit_03.png" alt=""> <h2 id="6">Part 3c</h2><pre class="codeinput">figure
hold <span class="string">on</span>
initial(sys, IC, 0:0.1:2)

yd = [];
yd(1) = 1;
Td = [];
Td(1) = 0;
<span class="comment">% Exact Discrete</span>
t = 0.1;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
<span class="keyword">for</span> i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; <span class="comment">% save corresponding discrete time integer index</span>
<span class="keyword">end</span>
ed = stem(Td*t,yd, <span class="string">'*'</span>, <span class="string">'DisplayName'</span>, <span class="string">'Exact Discrete'</span>);
ed.Color = <span class="string">'red'</span>;
t = 0.3;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
<span class="keyword">for</span> i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; <span class="comment">% save corresponding discrete time integer index</span>
<span class="keyword">end</span>
ed = stem(Td*t,yd, <span class="string">'*'</span>, <span class="string">'DisplayName'</span>, <span class="string">'Exact Discrete'</span>);
ed.Color = <span class="string">'green'</span>;
t = 0.5;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
<span class="keyword">for</span> i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; <span class="comment">% save corresponding discrete time integer index</span>
<span class="keyword">end</span>
ed = stem(Td*t,yd, <span class="string">'*'</span>, <span class="string">'DisplayName'</span>, <span class="string">'Exact Discrete'</span>);
ed.Color = <span class="string">'blue'</span>;
legend(<span class="string">'CT'</span>,<span class="string">'DT  T=0.1'</span>,  <span class="string">'DT  T=0.3'</span>, <span class="string">'DT  T=0.5'</span>)

hold <span class="string">off</span>
fprintf(<span class="string">"\nWhen T increases the discrete time signal matches better with continous time. When T decreases the DT signal loses alot of information but in general the discrete time signal is stable for all T"</span>)
</pre><pre class="codeoutput">
When T increases the discrete time signal matches better with continous time. When T decreases the DT signal loses alot of information but in general the discrete time signal is stable for all T</pre><img vspace="5" hspace="5" src="extra_credit_04.png" alt=""> <h2 id="7">Part 3d</h2><pre class="codeinput">figure
I = imread(<span class="string">'case1err.jpg'</span>);
imshow(I)
</pre><img vspace="5" hspace="5" src="extra_credit_05.png" alt=""> <h2 id="8">Part 4a</h2><h2 id="9">Part 4b</h2><pre class="codeinput">figure
step(sys, 0:0.01:2);
hold <span class="string">on</span>;
U = 1;
yd(1) = 0;
t = 0.1;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
<span class="keyword">for</span> i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; <span class="comment">% save corresponding discrete time integer index</span>
<span class="keyword">end</span>
ed = stem(Td*t,yd, <span class="string">'filled'</span>, <span class="string">'DisplayName'</span>, <span class="string">'Exact Discrete'</span>);
ed.Color = <span class="string">'blue'</span>;
t = 0.3;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
<span class="keyword">for</span> i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; <span class="comment">% save corresponding discrete time integer index</span>
<span class="keyword">end</span>
ed = stem(Td*t,yd, <span class="string">'filled'</span>, <span class="string">'DisplayName'</span>, <span class="string">'Exact Discrete'</span>);
ed.Color = <span class="string">'red'</span>;
t = 0.5;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
<span class="keyword">for</span> i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; <span class="comment">% save corresponding discrete time integer index</span>
<span class="keyword">end</span>
ed = stem(Td*t,yd, <span class="string">'filled'</span>, <span class="string">'DisplayName'</span>, <span class="string">'Exact Discrete'</span>);
ed.Color = <span class="string">'green'</span>;
</pre><img vspace="5" hspace="5" src="extra_credit_06.png" alt=""> <h2 id="10">Case II</h2><h2 id="11">Part 1</h2><pre class="codeinput">figure
I = imread(<span class="string">'case2part1.jpg'</span>);
imshow(I)
</pre><pre class="codeoutput">Warning: Image is too big to fit on screen; displaying at 25% 
</pre><img vspace="5" hspace="5" src="extra_credit_07.png" alt=""> <h2 id="12">Part 2</h2><pre class="codeinput">figure
I = imread(<span class="string">'case2part2.jpg'</span>);
imshow(I)
</pre><pre class="codeoutput">Warning: Image is too big to fit on screen; displaying at 25% 
</pre><img vspace="5" hspace="5" src="extra_credit_08.png" alt=""> <h2 id="13">Part 3a</h2><pre class="codeinput">figure
I = imread(<span class="string">'case2part3a.jpg'</span>);
imshow(I)
</pre><pre class="codeoutput">Warning: Image is too big to fit on screen; displaying at 25% 
</pre><img vspace="5" hspace="5" src="extra_credit_09.png" alt=""> <h2 id="14">Part 3b</h2><pre class="codeinput">figure
I = imread(<span class="string">'case2part3b.jpg'</span>);
imshow(I)
fprintf(<span class="string">"within the range of stability, samller the period, the higher the lower the error between the estimates\n"</span>)
fprintf(<span class="string">"this is because as you sample more frequently the estimates gets better matched to the original signal\n"</span>)
fprintf(<span class="string">"Larger the K value, more time for the method to converge hence lowering the error"</span>)
fprintf(<span class="string">"The result for this is different comapred to Case 1 part 3d because 3d was an exact solution, while this is an estimate, so 3d has no error component, while forward and backward methods do"</span>)
fprintf(<span class="string">"\n see next part for graph"</span>)
</pre><pre class="codeoutput">Warning: Image is too big to fit on screen; displaying at 25% 
within the range of stability, samller the period, the higher the lower the error between the estimates
this is because as you sample more frequently the estimates gets better matched to the original signal
Larger the K value, more time for the method to converge hence lowering the errorThe result for this is different comapred to Case 1 part 3d because 3d was an exact solution, while this is an estimate, so 3d has no error component, while forward and backward methods do
 see next part for graph</pre><img vspace="5" hspace="5" src="extra_credit_10.png" alt=""> <h2 id="15">Part 3c</h2><pre class="codeinput">close <span class="string">all</span>
A = [-5.0];
B = [2.0];
C = [1.0];
D = [];
t = .1;
IC = 1;
U = 0;

<span class="comment">% Forward Difference</span>
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);

sys = ss(A,B,C,D);
[Yc, Tc] = initial(sys, IC, 0:0.01:2);
hold <span class="string">on</span>;
initial(sys, IC, 0:0.01:2)
ybd = [];
yd = [];
yd(1) = 1;
Td = [];
Td(1) = 0;
<span class="comment">% Exact Discrete</span>
<span class="keyword">for</span> i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; <span class="comment">% save corresponding discrete time integer index</span>
<span class="keyword">end</span>
hold <span class="string">on</span>;
ed = stem(Td(1:11)*t,yd(1:11), <span class="string">'*'</span>, <span class="string">'DisplayName'</span>, <span class="string">'Exact Discrete'</span>);
ed.Color = <span class="string">'red'</span>;

yfd = [];
yfd(1) = 1;
Td = [];
Td(1) = 0;
<span class="comment">% Forward Difference</span>
<span class="keyword">for</span> i = 1:length(Tc)
    yfd(i+1) = (1+(t*A))*yfd(i) +(B*t*U);
    Td(i+1) = i;
<span class="keyword">end</span>
hold <span class="string">on</span>;
fd = stem(Td(1:11)*t,yfd(1:11), <span class="string">'filled'</span>,<span class="string">'DisplayName'</span>, <span class="string">'Forward Difference'</span>);
fd.Color = <span class="string">'green'</span>;
ybd = zeros(1, length(Td));
ybd(1) = 1;
<span class="comment">% Backward Difference</span>
<span class="keyword">for</span> k = 2:length(Td)
    z = 0;
    <span class="keyword">for</span> m = 1:k
        z = z + 1/(1-A*t)^(k-m+1) * (B*t*U);
    <span class="keyword">end</span>
    ybd(k) = ybd(1)*(1/((1-A*t)^k)) + z;
<span class="keyword">end</span>
bd = stem(Td(1:11)*t,ybd(1:11), <span class="string">'filled'</span>,<span class="string">'DisplayName'</span>, <span class="string">'Backward Difference'</span>);
bd.Color = <span class="string">'blue'</span>;
legend(<span class="string">'CT'</span>,<span class="string">'CT(kT)'</span>,<span class="string">'Fwd'</span>,<span class="string">'Back'</span>)

en_forward = [];
en_backward = [];
t = 0.1;
<span class="keyword">for</span> k = 1:11
    en_forward(k) = abs(exp(-5*k*t) - (1-5*t)^k);
    en_backward(k) = abs(exp(-5*k*t) - (1/(1+5*t)^k));
<span class="keyword">end</span>
k = 1:11;
figure
hold <span class="string">on</span>
stem(k, en_forward)
stem(k, en_backward)
title(<span class="string">"Error Norm for T = 0.1"</span>)
xlabel(<span class="string">"k"</span>)
ylabel(<span class="string">"error"</span>)
legend(<span class="string">"Foward"</span>, <span class="string">"Backward"</span>)
t = 0.3;
<span class="keyword">for</span> k = 1:11
    en_forward(k) = abs(exp(-5*k*t) - (1-5*t)^k);
    en_backward(k) = abs(exp(-5*k*t) - (1/(1+5*t)^k));
<span class="keyword">end</span>
k = 1:11;
figure
hold <span class="string">on</span>
stem(k, en_forward)
stem(k, en_backward)
title(<span class="string">"Error Norm for T = 0.3"</span>)
xlabel(<span class="string">"k"</span>)
ylabel(<span class="string">"error"</span>)
legend(<span class="string">"Foward"</span>, <span class="string">"Backward"</span>)
t = 0.05;
<span class="keyword">for</span> k = 1:11
    en_forward(k) = abs(exp(-5*k*t) - (1-5*t)^k);
    en_backward(k) = abs(exp(-5*k*t) - (1/(1+5*t)^k));
<span class="keyword">end</span>
k = 1:11;
figure
hold <span class="string">on</span>
stem(k, en_forward)
stem(k, en_backward)
title(<span class="string">"Error Norm for T = 0.05"</span>)
xlabel(<span class="string">"k"</span>)
ylabel(<span class="string">"error"</span>)
legend(<span class="string">"Foward"</span>, <span class="string">"Backward"</span>)
</pre><img vspace="5" hspace="5" src="extra_credit_11.png" alt=""> <img vspace="5" hspace="5" src="extra_credit_12.png" alt=""> <img vspace="5" hspace="5" src="extra_credit_13.png" alt=""> <img vspace="5" hspace="5" src="extra_credit_14.png" alt=""> <h2 id="16">Part 4a</h2><pre class="codeinput">figure
I = imread(<span class="string">'case2part4af.jpg'</span>);
imshow(I)
figure
I = imread(<span class="string">'case2part4ab.jpg'</span>);
imshow(I)
</pre><pre class="codeoutput">Warning: Image is too big to fit on screen; displaying at 67% 
Warning: Image is too big to fit on screen; displaying at 67% 
</pre><img vspace="5" hspace="5" src="extra_credit_15.png" alt=""> <img vspace="5" hspace="5" src="extra_credit_16.png" alt=""> <h2 id="17">Part 4b</h2><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2017b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% CASE I
close all
%setting initial condition
A = [-5.0];
B = [2.0]; 
C = [1.0];
D = [0];
t = 0.1;
IC = 1;
U = 0;
sys = ss(A,B,C,D);
[Yc, Tc] = initial(sys, IC, 0:t:2);

% State Discretition 
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
yd = [];
yd(1) = 1;
Td = [];
Td(1) = 0;
% Exact Discrete
for i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; % save corresponding discrete time integer index
end



%% Part 1

fprintf("After discretization Ad = expm(-5*t) Bd = ((-2/5)*expm(-5*t)) + (2/5)")
fprintf("State Equation: X[k+1] = Ad*X[k] + Bd*U[k]")
fprintf("Y[k] = X[k]")

%% Part 2
figure 
hold on
initial(sys, IC, 0:0.1:2)

yd = [];
yd(1) = 1;
Td = [];
Td(1) = 0;
% Exact Discrete
t = 0.1;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
for i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; % save corresponding discrete time integer index
end
ed = stem(Td*t,yd, '*', 'DisplayName', 'Exact Discrete');
ed.Color = 'red';
t = 0.3;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
for i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; % save corresponding discrete time integer index
end
ed = stem(Td*t,yd, '*', 'DisplayName', 'Exact Discrete');
ed.Color = 'green';
t = 0.5;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
for i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; % save corresponding discrete time integer index
end
ed = stem(Td*t,yd, '*', 'DisplayName', 'Exact Discrete');
ed.Color = 'blue';
legend('CT','DT  T=0.1',  'DT  T=0.3', 'DT  T=0.5')

hold off
fprintf("\nThe continous time signal is stable because as t approaches infinity, the amplitude approaches 0")
fprintf("\nThe discrete time signal is stabel for any time T > 0 can be seen from the graph as well for T = 0.1, 0.3, 0.5, the amplitude also approaches 0")

%% Part 3a
figure
fprintf("\nClose form continuous signal is x(t) = e^(A*t) * x(0) \n y(t) = x(t)")
I = imread('d.jpg');
imshow(I)

%% Part 3b
figure
hold on
initial(sys, IC, 0:t:2)
ed = stem(Td*t,yd, '*', 'DisplayName', 'Exact Discrete');
ed.Color = 'red';
legend('CT','DT  T=0.1')

%% Part 3c
figure
hold on
initial(sys, IC, 0:0.1:2)

yd = [];
yd(1) = 1;
Td = [];
Td(1) = 0;
% Exact Discrete
t = 0.1;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
for i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; % save corresponding discrete time integer index
end
ed = stem(Td*t,yd, '*', 'DisplayName', 'Exact Discrete');
ed.Color = 'red';
t = 0.3;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
for i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; % save corresponding discrete time integer index
end
ed = stem(Td*t,yd, '*', 'DisplayName', 'Exact Discrete');
ed.Color = 'green';
t = 0.5;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
for i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; % save corresponding discrete time integer index
end
ed = stem(Td*t,yd, '*', 'DisplayName', 'Exact Discrete');
ed.Color = 'blue';
legend('CT','DT  T=0.1',  'DT  T=0.3', 'DT  T=0.5')

hold off
fprintf("\nWhen T increases the discrete time signal matches better with continous time. When T decreases the DT signal loses alot of information but in general the discrete time signal is stable for all T")
%% Part 3d
figure
I = imread('case1err.jpg');
imshow(I)
%% Part 4a

%% Part 4b
figure
step(sys, 0:0.01:2);
hold on;
U = 1;
yd(1) = 0;
t = 0.1;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
for i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; % save corresponding discrete time integer index
end
ed = stem(Td*t,yd, 'filled', 'DisplayName', 'Exact Discrete');
ed.Color = 'blue';
t = 0.3;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
for i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; % save corresponding discrete time integer index
end
ed = stem(Td*t,yd, 'filled', 'DisplayName', 'Exact Discrete');
ed.Color = 'red';
t = 0.5;
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);
for i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; % save corresponding discrete time integer index
end
ed = stem(Td*t,yd, 'filled', 'DisplayName', 'Exact Discrete');
ed.Color = 'green';


%% Case II

%% Part 1
figure
I = imread('case2part1.jpg');
imshow(I)
%% Part 2
figure
I = imread('case2part2.jpg');
imshow(I)
%% Part 3a
figure
I = imread('case2part3a.jpg');
imshow(I)
%% Part 3b
figure
I = imread('case2part3b.jpg');
imshow(I)
fprintf("within the range of stability, samller the period, the higher the lower the error between the estimates\n")
fprintf("this is because as you sample more frequently the estimates gets better matched to the original signal\n")
fprintf("Larger the K value, more time for the method to converge hence lowering the error")
fprintf("The result for this is different comapred to Case 1 part 3d because 3d was an exact solution, while this is an estimate, so 3d has no error component, while forward and backward methods do")
fprintf("\n see next part for graph")
%% Part 3c
close all
A = [-5.0];
B = [2.0]; 
C = [1.0];
D = [];
t = .1;
IC = 1;
U = 0;

% Forward Difference
Ad = expm(-5*t);
Bd = ((-2/5)*expm(-5*t)) + (2/5);

sys = ss(A,B,C,D);
[Yc, Tc] = initial(sys, IC, 0:0.01:2);
hold on;
initial(sys, IC, 0:0.01:2)
ybd = [];
yd = [];
yd(1) = 1;
Td = [];
Td(1) = 0;
% Exact Discrete
for i = 1:length(Tc)
    yd(i+1) = Ad*yd(i) +(Bd*U);
    Td(i+1) = i; % save corresponding discrete time integer index
end
hold on;
ed = stem(Td(1:11)*t,yd(1:11), '*', 'DisplayName', 'Exact Discrete');
ed.Color = 'red';

yfd = [];
yfd(1) = 1;
Td = [];
Td(1) = 0;
% Forward Difference
for i = 1:length(Tc)
    yfd(i+1) = (1+(t*A))*yfd(i) +(B*t*U);
    Td(i+1) = i;
end
hold on;
fd = stem(Td(1:11)*t,yfd(1:11), 'filled','DisplayName', 'Forward Difference');
fd.Color = 'green';
ybd = zeros(1, length(Td));
ybd(1) = 1;
% Backward Difference
for k = 2:length(Td)
    z = 0;
    for m = 1:k
        z = z + 1/(1-A*t)^(k-m+1) * (B*t*U);
    end
    ybd(k) = ybd(1)*(1/((1-A*t)^k)) + z;
end
bd = stem(Td(1:11)*t,ybd(1:11), 'filled','DisplayName', 'Backward Difference');
bd.Color = 'blue';
legend('CT','CT(kT)','Fwd','Back')

en_forward = [];
en_backward = [];
t = 0.1;
for k = 1:11
    en_forward(k) = abs(exp(-5*k*t) - (1-5*t)^k);
    en_backward(k) = abs(exp(-5*k*t) - (1/(1+5*t)^k));
end
k = 1:11;
figure
hold on
stem(k, en_forward)
stem(k, en_backward)
title("Error Norm for T = 0.1")
xlabel("k")
ylabel("error")
legend("Foward", "Backward")
t = 0.3;
for k = 1:11
    en_forward(k) = abs(exp(-5*k*t) - (1-5*t)^k);
    en_backward(k) = abs(exp(-5*k*t) - (1/(1+5*t)^k));
end
k = 1:11;
figure
hold on
stem(k, en_forward)
stem(k, en_backward)
title("Error Norm for T = 0.3")
xlabel("k")
ylabel("error")
legend("Foward", "Backward")
t = 0.05;
for k = 1:11
    en_forward(k) = abs(exp(-5*k*t) - (1-5*t)^k);
    en_backward(k) = abs(exp(-5*k*t) - (1/(1+5*t)^k));
end
k = 1:11;
figure
hold on
stem(k, en_forward)
stem(k, en_backward)
title("Error Norm for T = 0.05")
xlabel("k")
ylabel("error")
legend("Foward", "Backward")
%% Part 4a
figure
I = imread('case2part4af.jpg');
imshow(I)
figure
I = imread('case2part4ab.jpg');
imshow(I)

%% Part 4b
##### SOURCE END #####
--></body></html>